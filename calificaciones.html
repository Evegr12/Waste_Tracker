<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="calificaciones.css">
    <title>Calificar Recolector</title>
</head>
<body>
    <header>
        <div class="logo">
            <a href="inicioRestaurante.html"><img src="logoWT.png" alt="Waste Tracker"></a>
            <h1>Waste Tracker</h1>
        </div>
        <nav>
            <a href="notificaciones.html"><img src="notificaciones.png" alt="Notificaciones"></a>
            <a href="historial.html"><img src="historial-icon.png" alt="Historial"></a>
            <a href="perfilRestaurante.html"><img src="perfil-icon.png" alt="Perfil"></a>
        </nav>
    </header>

    <div id="rating-container"></div> <!-- Aquí cargamos dinámicamente las calificaciones -->

    <footer>
        <nav class="footer-nav">
            <a href="inicioRestaurante.html"><img src="home-icon.png" alt="Inicio"></a>
            <a href="solicitudRecoleccion.html"><img src="bote-icon.png" alt="Bote"></a>
            <a href="calificaciones.html"><img src="calif-icon.png" alt="Calificar"></a>
        </nav>
    </footer>

    <script>
        document.getElementById('submit-calificacion').addEventListener('click', async () => {
  const calificacion = document.getElementById('calificacion').value;
  const comentario = document.getElementById('comentario').value;
  const fechaCalificacion = new Date().toLocaleDateString(); // Generar la fecha en el frontend

  try {
    const response = await fetch(`/calificar/${recoleccionId}`, {
      method: 'POST',
      headers: {
        'Authorization': `Bearer ${authToken}`,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({ calificacion, comentario })
    });

    const data = await response.json();
    if (response.ok) {
      // Mostrar la fecha generada localmente en la interfaz
      document.getElementById('fecha-calificacion').textContent = `Calificado el: ${fechaCalificacion}`;
    } else {
      console.error('Error al calificar:', data.message);
    }
  } catch (error) {
    console.error('Error en la solicitud:', error);
  }
});

    </script>
    
</body>
</html>
