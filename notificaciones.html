<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="notificaciones.css">
    <title>Waste Tracker - Notificaciones</title>
</head>
<body>
    <header>
        <div class="logo">
            <a href="inicioRestaurante.html">
                <img src="logoWT.png" alt="Waste Tracker">
            </a>
            <h1>Waste Tracker</h1>
        </div>
        <nav>
            <a href="notificaciones.html"><img src="notificaciones.png" alt="Notificaciones"></a>
            <a href="historial.html"><img src="historial-icon.png" alt="Historial"></a>
            <a href="perfilRestaurante.html"><img src="perfil-icon.png" alt="Perfil"></a>
        </nav>
    </header>

    <main>
        <div class="notifications">
            <h2>Notificaciones</h2>
            <!-- Aquí se agregarán las notificaciones dinámicamente -->
        </div>
    </main>

    <footer>
        <nav class="footer-nav">
            <a href="inicioRestaurante.html"><img src="home-icon.png" alt="Inicio"></a>
            <a href="solicitudRecoleccion.html"><img src="bote-icon.png" alt="Bote"></a>
            <a href="mapa.html"><img src="map-icon.png" alt="Mapa"></a>
            <a href="calificaciones.html"><img src="calif-icon.png" alt="Calificar"></a>
        </nav>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
    const initialNotificationDelay = 10000; // 10,000 ms = 10 segundos

    // Función para mostrar una notificación en la interfaz
    function mostrarNotificacion(texto) {
        const notificationContainer = document.querySelector('.notifications');
        const notificationItem = document.createElement('div');
        notificationItem.classList.add('notification');
        notificationItem.innerHTML = `
            <p class="message">${texto}</p>
            <div class="datetime">
                <span class="date">Fecha no especificada</span>
                <span class="time">Hora no especificada</span>
            </div>
        `;
        notificationContainer.appendChild(notificationItem);
    }

    // Función para obtener el mensaje de recolección
    function obtenerMensajeRecoleccion() {
        fetch('/mensaje-recoleccion')
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok: ' + response.status);
                }
                return response.json();
            })
            .then(data => {
                console.log('Mensaje de recolección:', data); // Añadir log para ver la respuesta
                if (data.success) {
                    mostrarNotificacion(data.mensaje);
                    localStorage.setItem('recoleccion_mostrado', 'true');
                } else {
                    console.error('Error en el servidor:', data.error);
                }
            })
            .catch(error => console.error('Error fetching mensaje de recolección:', error));
    }

    // Configurar temporizador para mostrar un consejo cada cierto tiempo (por ejemplo, cada 4 horas)
    function iniciarTemporizadorConsejo() {
        setInterval(fetchConsejoAleatorio, 4 * 60 * 60 * 1000); // 4 horas en milisegundos
        fetchConsejoAleatorio(); // Mostrar el primer consejo inmediatamente
    }

    // Verificar si ya se mostró el mensaje de recolección
    if (!localStorage.getItem('recoleccion_mostrado')) {
        obtenerMensajeRecoleccion();
    }

    iniciarTemporizadorConsejo();
});

    </script>
</body>
</html>
